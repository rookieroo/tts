# TTS 项目商用合规指南

## 📜 许可证分析

### F5-TTS
- **许可证**: MIT License
- **商用**: ✅ **完全允许**
- **限制**: 需保留版权声明
- **适用场景**: 任何商业用途，无限制

### IndexTTS (bilibili indextts2)
- **许可证**: bilibili Model Use License Agreement（自定义）
- **商用**: ⚠️ **有严格限制**
- **关键限制**:
  1. **用户规模限制**: 月活用户 > 1 亿，需单独申请许可
  2. **营收限制**: 年收入 > 10 亿人民币，需单独申请许可
  3. **禁止改进其他 AI 模型**: 不能用于训练其他模型（除非是非商业模型）
  4. **高风险场景禁用**: 医疗诊断、自动驾驶、军事应用等
  5. **中国法律管辖**: 争议由上海仲裁委员会裁决

## 🎯 商用推荐方案

### 方案 A：仅使用 F5-TTS（推荐小型商业项目）

**适用场景**:
- 初创公司
- MVP 产品验证
- 年营收 < 10 亿人民币
- 月活用户 < 1 亿

**实施方案**:
```bash
# 1. 保留 F5-TTS，移除 IndexTTS
cd <PROJECT_ROOT>
rm -rf index-tts
rm -f start_indextts.sh watch_indextts_log.sh

# 2. 更新启动脚本
# 只启动 F5-TTS 和 Cloudflare Tunnel
```

**优点**:
- ✅ MIT 许可证，无商用限制
- ✅ 法律风险最低
- ✅ 支持多语言（英文、中文）
- ✅ 零样本语音克隆能力强

**缺点**:
- ⚠️ 中文效果可能不如 IndexTTS

### 方案 B：双模型 + 许可证隔离（推荐中型企业）

**适用场景**:
- 需要对比不同模型效果
- 有法务团队审核
- 年营收 < 10 亿或月活 < 1 亿

**实施方案**:

1. **严格区分使用场景**
   ```bash
   F5-TTS     → 用于所有商业场景（无限制）
   IndexTTS   → 仅用于内部测试、研发（非生产环境）
   ```

2. **在代码中添加许可证检查**
   ```python
   # config.py
   PRODUCTION_TTS_ENGINE = "f5tts"  # 生产环境只用 F5-TTS
   ALLOW_INDEXTTS = False           # 生产环境禁用 IndexTTS
   
   # 在 API 中强制执行
   if PRODUCTION and tts_engine == "indextts":
       raise PermissionError("IndexTTS not allowed in production")
   ```

3. **部署架构**
   ```
   生产环境:
   ├── F5-TTS (7860) → f5tts.yourdomain.com
   └── Cloudflare Tunnel
   
   开发/测试环境:
   ├── F5-TTS (7860)
   ├── IndexTTS (7861) → 仅内网访问
   └── 无公网暴露
   ```

### 方案 C：申请 IndexTTS 商用许可（推荐大型企业）

**适用场景**:
- 年营收接近或超过 10 亿人民币
- 月活用户接近或超过 1 亿
- 需要最好的中文效果

**申请流程**:
1. 联系 bilibili 申请商用许可
2. 提交公司信息、使用场景
3. 协商授权费用
4. 签订书面协议

**联系方式**（参考 GitHub 仓库）:
- GitHub: https://github.com/index-tts/index-tts
- 提交 Issue 说明商用意向

### 方案 D：完全替代方案（最安全）

使用其他开源 TTS 模型，全部 MIT/Apache 许可证：

| 模型 | 许可证 | 中文支持 | 商用 | 专利保护 |
|------|--------|---------|------|----------|
| **F5-TTS** | MIT | ✅ 良好 | ✅ 无限制 | ❌ 无 |
| **CosyVoice** | Apache 2.0 | ✅ 优秀 | ✅ 无限制 | ✅ 有（授予使用权）|
| **ChatTTS** | AGPL 3.0 | ✅ 优秀 | ⚠️ 需开源 | ❌ 无 |
| **XTTS v2** | Apache 2.0 | ✅ 支持 | ✅ 无限制 | ✅ 有（授予使用权）|
| **Bark** | MIT | ✅ 支持 | ✅ 无限制 | ❌ 无 |

### Apache 2.0 vs MIT 对比

| 特性 | MIT | Apache 2.0 |
|------|-----|------------|
| **商用** | ✅ 完全允许 | ✅ 完全允许 |
| **修改** | ✅ 允许 | ✅ 允许 |
| **分发** | ✅ 允许 | ✅ 允许 |
| **专利授权** | ❌ 不明确 | ✅ 明确授予 |
| **商标使用** | 🤷 不涉及 | ❌ 明确禁止 |
| **修改声明** | ❌ 不要求 | ✅ 需声明 |
| **版权声明** | ✅ 需保留 | ✅ 需保留 + NOTICE 文件 |

**结论**: Apache 2.0 **商用完全无限制**，且比 MIT 更安全（有明确的专利授权）

推荐组合:
```bash
# 主力: F5-TTS (MIT)
# 备选: CosyVoice (Apache 2.0) - 阿里达摩院出品
# 特殊场景: XTTS v2 (Apache 2.0) - Coqui TTS
```

## 🔧 实施步骤（方案 A：仅 F5-TTS）

### 1. 清理 IndexTTS

```bash
cd <PROJECT_ROOT>

# 备份 IndexTTS（以防需要恢复）
tar -czf backups/index-tts-backup-$(date +%Y%m%d).tar.gz index-tts/

# 移除 IndexTTS
rm -rf index-tts/
rm -f start_indextts.sh watch_indextts_log.sh
```

### 2. 更新配置文件

更新 `~/.cloudflared/config.yml`，移除 IndexTTS 路由：

```yaml
tunnel: <YOUR_TUNNEL_ID>
credentials-file: /Users/<USER>/.cloudflared/<TUNNEL_ID>.json

ingress:
  # 只保留 F5-TTS
  - hostname: f5tts.example.com
    service: http://localhost:7860
    originRequest:
      connectTimeout: 300s
      keepAliveTimeout: 300s
      tcpKeepAlive: 300s
      noTLSVerify: false
      disableChunkedEncoding: true
  
  # 移除 IndexTTS 相关配置
  
  - service: http_status:404
```

### 3. 更新启动脚本

创建简化版 `restart_services.sh`:

```bash
#!/bin/bash
cd "$(dirname "$0")"

echo "🔄 重启 TTS 服务（仅 F5-TTS）..."
./stop_services.sh
sleep 2
./start_tunnel.sh
sleep 1
./start_f5tts.sh
echo "✅ 服务已重启"
```

更新 `stop_services.sh`:

```bash
#!/bin/bash
echo "🛑 停止所有服务..."

pkill -f "f5-tts_infer-gradio"
pkill -f "cloudflared tunnel"

echo "✅ 所有服务已停止"
```

更新 `check_status.sh`:

```bash
#!/bin/bash
echo "🔍 检查服务状态..."
echo "----------------------------------------"

echo "1. F5-TTS (端口 7860)"
if pgrep -f "f5-tts_infer-gradio" > /dev/null; then
    echo "✅ 正在运行 (PID: $(pgrep -f 'f5-tts_infer-gradio'))"
else
    echo "❌ 未运行"
fi

echo "----------------------------------------"
echo "2. Cloudflare Tunnel"
if pgrep -f "cloudflared tunnel" > /dev/null; then
    echo "✅ 正在运行 (PID: $(pgrep -f 'cloudflared tunnel'))"
else
    echo "❌ 未运行"
fi
echo "----------------------------------------"
```

### 4. 更新 README.md

添加许可证说明章节：

```markdown
## 📜 许可证与商用说明

### F5-TTS
- **许可证**: MIT License
- **商用**: ✅ 完全允许，无限制
- **要求**: 保留原始版权声明

本项目使用 F5-TTS 作为核心 TTS 引擎，完全符合商用要求。

### 商用合规性
- ✅ 可用于任何商业产品
- ✅ 可修改和二次开发
- ✅ 可集成到 SaaS 服务
- ✅ 无用户规模限制
- ✅ 无营收限制

### 版权声明
F5-TTS 版权归原作者所有，详见：
https://github.com/SWivid/F5-TTS/blob/main/LICENSE
```

### 5. 更新 .gitignore

```bash
# 添加备份目录
echo "backups/" >> .gitignore
```

## 📋 商用检查清单

在正式商用前，请确认：

### 技术层面
- [ ] 已移除或隔离非商用友好的组件（IndexTTS）
- [ ] 生产环境只使用 MIT/Apache 许可的模型
- [ ] 代码中保留了原始版权声明
- [ ] 有完整的备份和回滚方案

### 法务层面
- [ ] 已审查所有依赖项的许可证
- [ ] 记录了第三方组件清单
- [ ] 准备了许可证合规文档
- [ ] 如需使用受限模型，已获得书面授权

### 业务层面
- [ ] 评估了用户规模和营收预期
- [ ] 确认不在禁止的高风险场景
- [ ] 有隐私政策和服务条款
- [ ] 有内容审核机制（防止生成违法内容）

## 🔐 风险提示

### 使用 IndexTTS 的风险

1. **无授权商用** → 可能面临：
   - 许可证违约诉讼
   - 侵权赔偿（按营收计算）
   - 服务被迫下线
   - 商誉损失

2. **达到规模阈值未申请许可** → 可能面临：
   - 自动失去使用权（许可证 2.2 条款）
   - 追溯性赔偿
   - 被竞争对手举报

3. **技术限制违规**（如用于训练其他模型）→ 可能面临：
   - 许可证终止（5.1 条款）
   - 需赔偿损失（4.3 条款）

### 建议

对于商业项目：
1. **优先选择 MIT/Apache 许可证的模型**
2. **咨询法务团队审查许可证**
3. **保留所有授权文件和沟通记录**
4. **定期审查依赖项许可证变化**

## 💡 本地单机部署的商用现实

### 性能限制分析

你说得对！本地单机部署在商用规模上有明显限制：

#### macOS Apple Silicon (M1/M2/M3)
```
硬件: MacBook Pro M2 Max (38核GPU, 32GB RAM)
F5-TTS 性能:
├── 生成 10 秒音频: ~30-60 秒
├── 并发处理: 1-2 个请求
├── 日吞吐量: ~500-1000 次生成
└── 适用场景: 小型应用、Demo、个人项目

IndexTTS 性能:
├── 生成 10 秒音频: ~20-40 秒  
├── 并发处理: 1-2 个请求
├── 日吞吐量: ~800-1500 次生成
└── 适用场景: 内部工具、原型验证
```

#### 商用规模对比

| 场景 | 日请求量 | 推荐方案 | 成本 |
|------|---------|---------|------|
| **个人项目/Demo** | < 100 | 本地 Mac (M2) | 免费（已有设备）|
| **小型应用** | 100-1,000 | 本地 Mac + 队列 | < ¥100/月（电费）|
| **中型应用** | 1,000-10,000 | 云端 GPU (T4/A10) | ¥1,000-5,000/月 |
| **大型应用** | 10,000-100,000 | GPU 集群 (A100×4) | ¥20,000-50,000/月 |
| **超大规模** | > 100,000 | GPU 集群 + CDN | ¥100,000+/月 |

### 实际商用建议

#### 方案 1：本地开发 + 云端生产（推荐）

```bash
开发环境（本地 Mac）:
├── F5-TTS 本地调试
├── API 开发和测试
├── 小批量音频生成
└── 成本: 0

生产环境（云端）:
├── RunPod/Vast.ai 租用 GPU
│   └── RTX 4090: ~¥2-5/小时
├── AWS/GCP GPU 实例
│   └── T4: ~¥3-8/小时
├── 自建 GPU 服务器
│   └── RTX 4090: ~¥15,000（一次性）
└── API Gateway + 负载均衡
```

**示例架构**:
```
┌─────────────────────────────────────────┐
│         用户请求（API）                  │
└──────────────┬──────────────────────────┘
               │
               ▼
┌─────────────────────────────────────────┐
│   Cloudflare Workers / API Gateway      │
│   (路由、限流、缓存)                     │
└──────────────┬──────────────────────────┘
               │
               ▼
┌─────────────────────────────────────────┐
│    GPU 集群（按需扩展）                  │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐  │
│  │ GPU 1   │ │ GPU 2   │ │ GPU N   │  │
│  │ F5-TTS  │ │ F5-TTS  │ │ F5-TTS  │  │
│  └─────────┘ └─────────┘ └─────────┘  │
└─────────────────────────────────────────┘
               │
               ▼
┌─────────────────────────────────────────┐
│      对象存储（音频缓存）                │
│      S3 / OSS / R2                      │
└─────────────────────────────────────────┘
```

#### 方案 2：混合部署

```bash
本地 Mac（轻量级请求）:
├── 离线音频生成
├── 内部员工使用
└── 开发测试

云端 GPU（商用流量）:
├── 用户请求
├── 批量处理
└── 高并发场景
```

#### 方案 3：API 服务（最简单）

不自己部署，使用第三方 API：

| 服务商 | 模型 | 价格 | 许可证 |
|--------|------|------|--------|
| **ElevenLabs** | 自研 | $5-$99/月 | 商业 API |
| **Play.ht** | 多模型 | $19-$99/月 | 商业 API |
| **Azure TTS** | Neural TTS | ¥0.016/1000 字 | 商业 API |
| **Google TTS** | WaveNet | $0.000016/字符 | 商业 API |

**何时用 API**:
- ✅ 初创公司（< 1 万日请求）
- ✅ 不想维护基础设施
- ✅ 需要稳定性保障
- ❌ 成本随规模线性增长

### 许可证与部署规模的关系

**重要澄清**:

```
许可证限制 ≠ 技术限制

IndexTTS 许可证限制:
❌ 月活 > 1 亿
❌ 年收入 > 10 亿人民币

技术限制（本地 Mac）:
❌ 日处理量 < 1000 次
❌ 无法支撑商用规模

结论: 即使有许可证，单机性能也不足以达到违规阈值
```

### 实际商用门槛

要达到 IndexTTS 许可证的限制阈值（月活 1 亿），需要：

```
假设每用户每月使用 10 次 TTS:
├── 总请求: 1 亿用户 × 10 次 = 10 亿次/月
├── 日请求: 10 亿 ÷ 30 = 3333 万次/天
├── 秒请求: 3333 万 ÷ 86400 = ~386 次/秒
│
所需硬件（假设每次生成 30 秒）:
├── GPU 数量: 386 × 30 秒 ÷ 1 GPU = 11,580 GPU 并行
├── 或者: 386 ÷ 10 (队列) = 1,158 个 GPU
├── 成本: 1,158 GPU × ¥2万/GPU = ¥2316 万（硬件）
└── 电费: ~¥100 万/月

实际情况:
- 你的 Mac: 1 GPU, ~1 次/秒峰值
- 达到限制需要: 11,580 倍扩展
- 结论: 单机物理上不可能违规
```

### 现实商用路径

```
阶段 1: 本地开发（0-100 用户）
├── 设备: MacBook Pro M2
├── 成本: ¥0
├── 许可证: MIT (F5-TTS) 完全合规
└── IndexTTS: 仅测试用

阶段 2: 小规模商用（100-1000 用户）
├── 设备: 云端 1-2 GPU (T4/4090)
├── 成本: ¥1000-3000/月
├── 许可证: MIT 合规
└── IndexTTS: 不使用（避免风险）

阶段 3: 中等规模（1000-10000 用户）
├── 设备: GPU 集群 (4-8 GPU)
├── 成本: ¥10,000-30,000/月
├── 许可证: MIT 合规
└── IndexTTS: 如需使用，申请授权

阶段 4: 大规模（> 10000 用户）
├── 设备: 专业 GPU 集群
├── 成本: ¥50,000+/月
├── 许可证: MIT 合规
└── IndexTTS: 必须申请授权（如果月活接近 1 亿）
```

### 结论

1. **Apache 2.0 确实商用无限制**（比 MIT 更安全）
2. **本地 Mac 无法达到商用规模**（物理限制）
3. **IndexTTS 的限制阈值极高**（需要百万级投资才能触及）
4. **实际建议**: 
   - 个人/小团队: 本地 F5-TTS (MIT) ✅
   - 初创公司: 云端 F5-TTS (MIT) ✅
   - 大型企业: 评估是否需要 IndexTTS + 申请授权

**实用建议**: 
- 在达到日请求 1 万次之前，不用担心性能问题
- 在月活达到 1000 万之前，不用担心 IndexTTS 许可证
- **现阶段**: 专注产品开发，使用 MIT 许可的 F5-TTS 即可

## 📞 需要帮助？

- 法律咨询：咨询你的法务团队或知识产权律师
- 技术咨询：查看各 TTS 项目的 GitHub Issues
- bilibili 授权：通过 GitHub 联系 IndexTTS 维护者
- GPU 租用: RunPod.io, Vast.ai, Lambda Labs

---

**最后更新**: 2025年11月23日  
**免责声明**: 本文档仅供参考，不构成法律建议。商用前请咨询专业法律顾问。
